
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js" integrity="sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ" crossorigin="anonymous"></script>

  <script>
    document.addEventListener("DOMContentLoaded", function() {
        var macros_dict = { {% for macro, replacement in (LATEX_MACROS or {}).items() %}
            "{{ macro | replace('\\', '\\\\') | safe }}": "{{ replacement | replace('\\', '\\\\') | safe }}" {% if not loop.last %} , {% endif %} {% endfor %}
            // {{ article.latex_macros }}
        {#{% for macro, replacement in (article.latex_macros or {}).items() %} {% if loop.first %} , {% endif %-}
            "{{ macro | replace('\\', '\\\\') | safe }}": "{{ replacement | replace('\\', '\\\\') | safe }}" {% if not loop.last %} , {% endif %} {% endfor %}#}
        };

        document.querySelectorAll("script[type='math/tex']").forEach(function(el) {
            var text = el.textContent === "" ? el.innerHTML : el.textContent;
            el.outerHTML = katex.renderToString(text, { displayMode: false, macros: macros_dict });
        });

        document.querySelectorAll("script[type='math/tex; mode=display']").forEach(function(el) {
            var text = el.textContent === "" ? el.innerHTML : el.textContent;
            el.outerHTML = katex.renderToString(text, { displayMode: true, macros: macros_dict });
        });
    });
  </script>

